language: node_js
node_js:
- '8'
dist: trusty
services:
- mongodb
env:
- CI=false NODE_ENV=ci PORT=3000
cache:
  directories:
  - node_modules
  - client/node_modules
install:
- npm install
- npm run build
script:
- nohup npm run start &
- sleep 3
- npm run test
notifications:
  email:
    recipients:
    - moogunjung@gmail.com
    on_success: always
    on_failure: always
deploy:
  provider: heroku
  api_key:
    secure: JiUHiik4u2Tvr3vCPWzdL8ny3H7k6Dz6OtcUPnVlbnbbPU88Ic7zZwKqY9q1AxIg+EJ/y/9QLfXqWRzNNnZXCBU+lRh3Tc7kH4uwyIlGdeDHoIp15I0cJxCNd366TUHCcp+iy8/8qK4cw33Suo65EkQ+gK8G7pa5OtUEzmUB7VqdMIocknDYmlEKhZU/5OlOAWLXpeJkI6R/Bfx+BHj4Skr2Cc0N1FKqUeVE7UkIi3rEhOvbtwrOkBqiaP1BTOopOyjB+xswsj8envXeijM8VQdI5k/7GBHqJCf5en5D5Z71+9RoHvIvsMU06OMDcetI8Dk5QljBWp4Cx0UCFmzugnJ0+Wf7QEk6bPoszI/vgMfzy4rrzSUBuMKVPfI6FufpMrZP8d2D6/tEMykXQT0z1ZUsJn3VikxQXhFA0pbgTQ2Dngk4dFd1bvSZ3AANqlDoeD0J6FGS34o0WkhuGyxGx+aFoeSIg/5O9JjIKdIcp1mxOf9O3MiAtB3wgWtALLTcMRB1Ztev341KB+6gg57QknHltt5c6pjusHiCEbSTNma4S/qmmwaDpVNi328XTavyY7LOEZG2x8Hb2YM943TTT4NQZr+LHOs6stHTkJsrhki/zvlyQwh4E5eB3xndssEIMW97u71tz7KxqNBbNv9JvIb2yjxUntVugt6kvxcNVGQ=
  app: node-react-dev
  on:
    repo: Moogun/Email-Survey
